<div class='mf-overlay-container' *ngIf='isOpen'>
  <div class='mf-overlay' (click)='isOpen = false'></div>
</div>

<div class='select' [ngClass]='{ "open": isOpen }'>
  <div class='select-selected' (click)='toggle()'>
    <span class='placeholder' *ngIf='!model'>Select...</span>
    <span>{{ getLabel(model) }}</span>
    <span class='icons'>
      <i class='fa fa-times' *ngIf='model' (click)='selectItem(null)'></i>
      <i class='fa fa-caret-down'></i>
    </span>
  </div>
  <div class='select-dropdown' #dropdownPanel
    [class.top]='currentDropdownPosition === "top"'
    [class.bottom]='currentDropdownPosition === "bottom"'
    [ngStyle]='{ visibility: isOpen ? "visible": "hidden"}'
    [style.width]='dropdownWidth + "px"'
  >
    <div class='search-container'>
      <input #searchInput
        type='search'
        placeholder='Search...'
        (input)='onSearch(searchInput.value)'
      />
      <i *ngIf='enableAddAction' class='fa fa-plus-circle fa-2x' (click)='onAddAction()'></i>
      <!-- To make this better we could make the search input a separate component/directive in order to "get" it in this component. -->
      <!-- <ng-container
        [ngTemplateOutlet]='searchTemplate || defaultSearchTemplate'
        [ngTemplateOutletContext]='{ item: item, searchTemplate: defaultSearchTemplate }'
      ></ng-container> -->
    </div>

    <virtual-scroll class='option-container'
      [bufferAmount]='4'
      [items]='filteredItems'
      [scrollAnimationTime]='500'
      (update)='viewPortItems = $event'
    >
      <div class='option' role='option' (click)='selectItem(item)' (mousedown)='$event.preventDefault()'
        *ngFor='let item of viewPortItems;'
        [class.marked]='item === this.filteredItems[markedItem]'
        [mfOptionHighlight]='searchTerm'
        [innerHTML] = 'getLabel(item)'
      >
      </div>
    </virtual-scroll>
  </div>
</div>



